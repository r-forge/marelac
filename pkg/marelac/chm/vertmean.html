<html><head><title>Vertical Volumetric Weighted Mean of Matter Concentrations in Water Bodies</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>vertmean(marelac)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   vertmean">
<param name="keyword" value=" Vertical Volumetric Weighted Mean of Matter Concentrations in Water Bodies">
</object>


<h2>Vertical Volumetric Weighted Mean of Matter Concentrations in Water Bodies</h2>


<h3>Description</h3>

<p>
Calculate vertical mean values which respect depths of different layers or
lake morphometry.
</p>


<h3>Usage</h3>

<pre>
vertmean(depth, vari, level, top, bot, vol)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>depth</code></td>
<td>
sorted vector of sampled depths,</td></tr>
<tr valign="top"><td><code>vari</code></td>
<td>
measurements corresponding to <code>depth</code> (concentration, temperature, ...),</td></tr>
<tr valign="top"><td><code>level</code></td>
<td>
surface water level (above ground or m NN, depending on bathymetric function used,</td></tr>
<tr valign="top"><td><code>top</code></td>
<td>
top water level of requested layer,</td></tr>
<tr valign="top"><td><code>bot</code></td>
<td>
bottom water level of requested layer,</td></tr>
<tr valign="top"><td><code>vol</code></td>
<td>
hypsographic function to be used (e.g. <code>vol.depth</code>).</td></tr>
</table>

<h3>Value</h3>

<p>
Volumetric average value of the requested layer between depths <code>top</code> and <code>bottom</code>.</p>

<h3>Examples</h3>

<pre>
## define a bathymetric formula for a given lake or basin
weight.vol &lt;- function(z, level) {
  ## Ground level 154m NN
  zz  &lt;- level - 154 - z
  ## interpolate at very small values
  vol &lt;- ifelse(zz &lt; 0.5,
    approx(c(0, 0.5), c(0, 18020.74), zz)$y,
    ## Polynomial
    vol &lt;- 44331 - 202176 * zz + 363281 * zz^2 - 150342 * zz^3 + 47275.8 * zz^4 -
          6791.125 * zz^5 + 503.9106 * zz^6 - 18.95684 * zz^7 + 0.2871075 * zz^8
  )
  vol
}

## dummy formula for depth-weighted averaging
## (water column, instead of bathymetric curve)
weight.column &lt;- function(z, level) {z}

## Plot of bathymetric curve
x &lt;- seq(0, 155, 0.01)
y &lt;- weight.vol(0, x)
plot(x, y, xlim = c(154, max(x)))

## Test Data
level &lt;- 167.5

depth &lt;- c(0, 1, 6, 7, 8, 9, 10, 11)
pconc &lt;- c(18.8, 17, 12.1, 11.9, 11.8, 11.7, 11.4, 11.4)

vertmean(depth, pconc, level, top=0, bot=4, weight.column)
vertmean(depth, pconc, level, top=4, bot=13.5, weight.column)

vertmean(depth, pconc, level, top=0, bot=4, weight.vol)
vertmean(depth, pconc, level, top=4, bot=13.5, weight.vol)

vertmean(depth, pconc, level, top=0, bot=3.7, weight.vol)
vertmean(depth, pconc, level, top=3.7, bot=13.5, weight.vol)

vertmean(depth, pconc, level, top=0, bot=3.7, weight.vol)
vertmean(depth, pconc, level, top=3.7, bot=13.5, weight.vol)

</pre>



<hr><div align="center">[Package <em>marelac</em> version 1.3 <a href="00Index.html">Index]</a></div>

</body></html>
